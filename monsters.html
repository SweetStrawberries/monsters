<!doctype html>
<meta charset="utf-8">
<title>Анимация объекта</title>
<canvas width="128" height="128"></canvas>
<script>
//Создание объекта monster
var monster =
{
 //Файл с изображением монстра и размер каждого кадра
 IMAGE: "frames.png",
 SIZE: 128,
 //Номер последнего кадра анимации и номер текущего кадра
 numberOfFrames: 5,
 currentFrame: 0,
 //Свойства X и Y позиций кадра в наборе кадров
 //При загрузке объекта они равны 0
 sourceX: 0,
 sourceY: 0,
 //Метод updateAnimation объекта
updateAnimation: function()
 {
 //Поиск в наборе кадров позиций кадра для отображения
 this.sourceX = this.currentFrame * this.SIZE;
 this.sourceY = 0;
 //Переход к следующему кадру
 if(this.currentFrame < this.numberOfFrames)
 {
 this.currentFrame++;
 }
 }
};
//Установка холста и поверхности рисования
var canvas = document.querySelector("canvas");
var drawingSurface = canvas.getContext("2d");
	//Загрузка набора кадров анимации
var image = new Image();
image.addEventListener("load", loadHandler, false);
image.src = monster.IMAGE;
function loadHandler()
{
 //Старт анимации
 updateAnimation();
}
function updateAnimation()
{
 //Планирование вызова updateAnimation через 300 мс
 setTimeout(updateAnimation, 300);
 //Обновление отображения анимационного кадра
 monster.updateAnimation();
 //Отображение анимации
 render();
}
function render()
{
 //Очистка холста от предыдущего кадра
 drawingSurface.clearRect(0, 0, canvas.width, canvas.height);
 //Отображение текущего кадра анимации
 drawingSurface.drawImage(image,
 monster.sourceX, monster.sourceY,
 monster.SIZE, monster.SIZE,
 0, 0, monster.SIZE, monster.SIZE);
}
</script>
